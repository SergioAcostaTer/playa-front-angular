<div class="register">
  <app-panel-image></app-panel-image>

  <div class="register__panel">
    <a href="/" class="register__logo">
      <h1 class="register__title">
        Playea<span class="register__title-icon">®</span>
      </h1>
    </a>
    <h2 class="register__subtitle">Crear una cuenta</h2>
    <p class="register__text">
      ¿Ya tienes una cuenta? <a href="/auth/login" class="register__link">Iniciar sesión</a>
    </p>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register__form">
      <div class="register__input-group">
        <div class="register__input-wrapper">
          <input
            type="text"
            placeholder="Nombre"
            name="firstName"
            class="register__input"
            formControlName="firstName"
            [ngClass]="{
              'register__input--error': registerForm.get('firstName')?.touched && registerForm.get('firstName')?.invalid,
              'register__input--valid': registerForm.get('firstName')?.touched && registerForm.get('firstName')?.valid
            }"
          >
          @if (isRequired('firstName')) {
            <p class="register__validation-message">Este campo es requerido</p>
          }
        </div>
        <div class="register__input-wrapper">
          <input
            type="text"
            name="lastName"
            placeholder="Apellido"
            class="register__input"
            formControlName="lastName"
            [ngClass]="{
              'register__input--error': registerForm.get('lastName')?.touched && registerForm.get('lastName')?.invalid,
              'register__input--valid': registerForm.get('lastName')?.touched && registerForm.get('lastName')?.valid
            }"
          >
          @if (isRequired('lastName')) {
            <p class="register__validation-message">Este campo es requerido</p>
          }
        </div>
      </div>

      <div class="register__input-wrapper">
        <input
          type="email"
          name="email"
          placeholder="Correo electrónico"
          class="register__input"
          formControlName="email"
          [ngClass]="{
            'register__input--error': registerForm.get('email')?.touched && registerForm.get('email')?.invalid,
            'register__input--valid': registerForm.get('email')?.touched && registerForm.get('email')?.valid
          }"
        >
        @if (isRequired('email')) {
          <p class="register__validation-message">Este campo es requerido</p>
        }
        @if (hasEmailError()) {
          <p class="register__validation-message">El correo electrónico no es válido</p>
        }
      </div>

      <div class="register__password-wrapper">
        <div class="register__password-container"
          [ngClass]="{
            'register__input--error': registerForm.get('password')?.touched && (registerForm.get('password')?.invalid || hasPasswordMatchError()),
            'register__input--valid': registerForm.get('password')?.touched && registerForm.get('password')?.valid && !hasPasswordMatchError()
          }"
        >
          <input
            id="register-password-text"
            [type]="passwordVisible ? 'text' : 'password'"
            placeholder="Ingresa tu contraseña"
            class="register__input register__input--password"
            formControlName="password"
          >
          <button type="button" class="register__password-toggle" (click)="togglePassword()">
            <img
              id="register-toggle-icon"
              [src]="passwordVisible ? '/images/Showing.png' : '/images/NotShowing.png'"
              alt="Toggle Password Visibility"
              class="register__password-icon"
            >
          </button>
        </div>
        <div class="register__validation-messages">
          @if (isRequired('password')) {
            <p class="register__validation-message">Este campo es requerido</p>
          }
          @if (hasPasswordLengthError()) {
            <p class="register__validation-message">Mínimo 6 caracteres</p>
          }
        </div>
      </div>

      <div class="register__password-wrapper">
        <div class="register__password-container"
          [ngClass]="{
            'register__input--error': registerForm.get('confirmPassword')?.touched && (registerForm.get('confirmPassword')?.invalid || hasPasswordMatchError()),
            'register__input--valid': registerForm.get('confirmPassword')?.touched && registerForm.get('confirmPassword')?.valid && !hasPasswordMatchError()
          }"
        >
          <input
            id="register-password-confirmation-text"
            [type]="confirmPasswordVisible ? 'text' : 'password'"
            placeholder="Confirma tu contraseña"
            class="register__input register__input--password"
            formControlName="confirmPassword"
          >
          <button type="button" class="register__password-toggle" (click)="toggleConfirmationPassword()">
            <img
              id="confirmation-toggle-icon"
              [src]="confirmPasswordVisible ? '/images/Showing.png' : '/images/NotShowing.png'"
              alt="Toggle Password Visibility"
              class="register__password-icon"
            >
          </button>
        </div>
        <div class="register__validation-messages">
          @if (isRequired('confirmPassword')) {
            <p class="register__validation-message">Este campo es requerido</p>
          }
          @if (hasPasswordMatchError()) {
            <p class="register__validation-message">Las contraseñas no coinciden</p>
          }
        </div>
      </div>

      <div class="register__checkbox-group">
        <input type="checkbox" id="terms" class="register__checkbox" formControlName="terms">
        <label for="terms" class="register__terms-label">
          Acepto los <a href="#" class="register__terms-link">Términos y Condiciones</a>
        </label>
        @if (isRequired('terms')) {
          <p class="register__validation-message">Debes aceptar los términos</p>
        }
      </div>

      <button type="submit" class="register__button" [disabled]="registerForm.invalid || hasPasswordMatchError() || isLoading">
        {{ isLoading ? 'Cargando...' : 'Crear cuenta' }}
      </button>

      <div class="register__divider">
        <span class="register__or-text">O regístrate con</span>
      </div>

      <app-social-buttons></app-social-buttons>
    </form>
  </div>
</div>